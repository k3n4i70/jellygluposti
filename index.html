<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jellycat World | Official Store</title>
    <link href="https://cdn11.bigcommerce.com/s-23s5gfmhr7/product_images/1/favicon.png" rel="shortcut icon">  
    <!-- CSS –°–¢–ò–õ–ò–ó–ê–¶–ò–Ø -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap');

        :root {
            --bg-color: #F9F7F2;
            --primary-color: #B2AC88; /* Sage Green */
            --accent-color: #DCAE96;  /* Dusty Rose */
            --text-color: #333333;
            --card-bg: #ffffff;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0; padding: 0;
            overflow-x: hidden;
        }

        /* HEADER */
        header {
            background-color: white;
            padding: 15px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            position: sticky; top: 0; z-index: 100;
        }

        .logo { font-size: 24px; font-weight: bold; color: var(--primary-color); text-decoration: none; cursor: pointer; }

        .btn-nav {
            background: none; border: 2px solid var(--primary-color);
            padding: 8px 18px; border-radius: 20px;
            cursor: pointer; font-family: inherit; font-weight: bold;
            transition: 0.3s; margin-left: 5px;
        }
        .btn-nav:hover { background: var(--primary-color); color: white; }
        .cart-btn { background: var(--accent-color); color: white; border: none; }

        /* HERO SECTION */
        .hero { text-align: center; padding: 60px 20px; background: white; margin-bottom: 20px; }
        .hero h1 { font-size: 2.5rem; margin-bottom: 10px; color: var(--text-color); }

        /* PRODUCT GRID */
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 30px; }

        .product-card {
            background: var(--card-bg); border-radius: 25px; padding: 20px;
            text-align: center; transition: 0.3s; position: relative;
            box-shadow: 0 5px 15px rgba(0,0,0,0.03);
        }
        .product-card:hover { transform: translateY(-10px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); }
        .product-card img { width: 100%; height: 200px; object-fit: contain; border-radius: 15px; }
        .product-card h3 { margin: 15px 0 5px; font-size: 1.2rem; }
        .price { color: var(--primary-color); font-weight: bold; font-size: 1.1rem; }

        .status-badge {
            position: absolute; top: 15px; right: 15px; font-size: 0.7rem;
            padding: 4px 10px; border-radius: 15px; background: #eee;
        }
        .status-retired { background: #ffcccc; color: #cc0000; }

        .btn {
            background-color: var(--primary-color); color: white; border: none;
            padding: 10px 20px; border-radius: 50px; cursor: pointer;
            width: 100%; margin-top: 15px; font-family: inherit; font-weight: bold;
        }

        /* MODAL WINDOW */
        .modal {
            display: none; position: fixed; z-index: 1000;
            left: 0; top: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.6); backdrop-filter: blur(5px);
            align-items: center; justify-content: center;
        }
        .modal-content {
            background-color: white; padding: 30px; border-radius: 30px;
            max-width: 450px; width: 90%; text-align: center; position: relative;
        }
        .modal-content img { width: 100%; max-height: 250px; object-fit: contain; border-radius: 20px; margin-bottom: 15px; }
        .close { position: absolute; top: 15px; right: 20px; font-size: 30px; cursor: pointer; color: #888; }

        /* CHECKOUT SECTION */
        .checkout-section { display: none; background: white; padding: 40px; border-radius: 30px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); }
        .checkout-section input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 15px; border: 1px solid #ddd; box-sizing: border-box; }
        .cart-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee; }
    </style>
</head>
<body>

<header>
    <a class="logo" onclick="showSection('shop')">üß∏ Jellycat Shop</a>
    <nav>
        <button class="btn-nav" onclick="filterProducts(null)">All</button>
        <button class="btn-nav cart-btn" onclick="showSection('checkout')">
            üõí Cart (<span id="cart-count">0</span>)
        </button>
    </nav>
</header>

<div id="hero-area" class="hero">
    <h1>Find your plushy friend</h1>
    <p>Handpicked Jellycat plushies by SMS</p>
</div>

<!-- –ú–ê–ì–ê–ó–ò–ù -->
<div id="shop-page" class="container">
    <div id="product-container" class="product-grid">
        <p style="text-align: center;">Loading the amuseables...</p>
    </div>
</div>

<!-- –ö–û–õ–ò–ß–ö–ê –ò –ü–û–†–™–ß–ö–ê -->
<div id="checkout-page" class="container checkout-section">
    <h2>Your Cart</h2>
    <div id="cart-items-list"></div>
    <h3 id="cart-total" style="text-align: right; margin: 20px 0;">Subtotal: 0 ‚Ç¨</h3>
    <hr>
    <h3>Delivery Info</h3>
    <input type="text" id="custName" placeholder="Your Names">
    <input type="text" id="custAddress" placeholder="Addres">
    <input type="email" id="custEmail" placeholder="e-mail">
    <button class="btn" onclick="submitOrder()">Finish order</button>
    <button class="btn" style="background: #ccc;" onclick="showSection('shop')">Back</button>
</div>

<!-- –ú–û–î–ê–õ–ï–ù –ü–†–û–ó–û–†–ï–¶ -->
<div id="productModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <img id="modalImg" src="" alt="">
        <h2 id="modalName"></h2>
        <p id="modalDesc"></p>
        <p class="price" id="modalPrice"></p>
        <button class="btn" id="addToCartBtn">Add to cart</button>
    </div>
</div>

<!-- FIREBASE –õ–û–ì–ò–ö–ê -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getFirestore, collection, getDocs, query, where, orderBy, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBkrjRjqo__uK4lOPR9n4MuzUogEgE7mTg",
    authDomain: "jellygluposti-c87b2.firebaseapp.com",
    projectId: "jellygluposti-c87b2",
    storageBucket: "jellygluposti-c87b2.firebasestorage.app",
    messagingSenderId: "214701739480",
    appId: "1:214701739480:web:523484045b901669c236ad"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  let cart = [];

  // 1. –§–£–ù–ö–¶–ò–Ø –ó–ê–†–ï–ñ–î–ê–ù–ï –ù–ê –ü–†–û–î–£–ö–¢–ò
  async function loadProducts(filterStatus = null) {
    const container = document.getElementById('product-container');
    container.innerHTML = '<p>Loading...</p>';

    let q = query(collection(db, "products"), orderBy("price", "asc"));
    if (filterStatus) {
      q = query(collection(db, "products"), where("status", "==", filterStatus));
    }

    const querySnapshot = await getDocs(q);
    container.innerHTML = '';
    
    querySnapshot.forEach((doc) => {
      const p = doc.data();
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –ª–∏–Ω–∫ –Ω–∞ —Å–Ω–∏–º–∫–∞ (—Ä–∞–∑–ª–∏—á–Ω–∏ –∏–º–µ–Ω–∞ –Ω–∞ –ø–æ–ª–µ—Ç–∞ –≤ Firebase)
      const img = p.imageurl || p.imageUrl || p.image || 'https://placehold.co/400x400?text=Jellycat';
      
      const productHTML = `
        <div class="product-card">
            <span class="status-badge ${p.status === 'Retired' ? 'status-retired' : ''}">${p.status}</span>
            <img src="${img}" alt="${p.name}">
            <h3>${p.name}</h3>
            <p class="price">${p.price} ‚Ç¨</p>
            <button class="btn" onclick="openProductModal('${p.name}', '${p.price}', '${img}', '${p.description || "Skibidi Gyat Rizz Lvl 999"}')">Buy</button>
        </div>
      `;
      container.innerHTML += productHTML;
    });
  }

  // 2. –û–¢–í–ê–†–Ø–ù–ï –ù–ê –ú–û–î–ê–õ (–°–™–° –°–ù–ò–ú–ö–ê)
  window.openProductModal = (name, price, img, desc) => {
    document.getElementById('modalImg').src = img;
    document.getElementById('modalName').innerText = name;
    document.getElementById('modalDesc').innerText = desc;
    document.getElementById('modalPrice').innerText = price + " ‚Ç¨";
    document.getElementById('productModal').style.display = 'flex';

    document.getElementById('addToCartBtn').onclick = () => {
        cart.push({ name, price: parseFloat(price) });
        updateUI();
        closeModal();
    };
  };

  window.closeModal = () => { document.getElementById('productModal').style.display = 'none'; };

  // 3. –ö–û–õ–ò–ß–ö–ê
  function updateUI() {
    document.getElementById('cart-count').innerText = cart.length;
    const list = document.getElementById('cart-items-list');
    list.innerHTML = cart.map(i => `<div class="cart-item"><span>${i.name}</span><b>${i.price} ‚Ç¨</b></div>`).join('');
    const total = cart.reduce((s, i) => s + i.price, 0);
    document.getElementById('cart-total').innerText = `–û–±—â–æ: ${total.toFixed(2)} ‚Ç¨`;
  }

  // 4. –ò–ó–ü–†–ê–©–ê–ù–ï –ù–ê –ü–û–†–™–ß–ö–ê
  window.submitOrder = async () => {
    const name = document.getElementById('custName').value;
    const addr = document.getElementById('custAddress').value;
    const email = document.getElementById('custEmail').value;

    if (!name || !addr || cart.length === 0) return alert("Enter details and/or add products!");

    try {
        await addDoc(collection(db, "orders"), {
            customer: name, address: addr, email: email,
            items: cart, date: new Date().toLocaleString()
        });
        alert("Order was sent!");
        cart = []; updateUI(); showSection('shop');
    } catch (e) { alert("–ì—Ä–µ—à–∫–∞: " + e.message); }
  };

  // –ù–ê–í–ò–ì–ê–¶–ò–Ø
  window.showSection = (s) => {
    document.getElementById('shop-page').style.display = s === 'shop' ? 'block' : 'none';
    document.getElementById('hero-area').style.display = s === 'shop' ? 'block' : 'none';
    document.getElementById('checkout-page').style.display = s === 'checkout' ? 'block' : 'none';
  };

  window.filterProducts = (status) => { showSection('shop'); loadProducts(status); };

  // –°—Ç–∞—Ä—Ç
  loadProducts();
</script>

</body>
</html>
